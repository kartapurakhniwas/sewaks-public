"use strict";(self.webpackChunksewaks_public=self.webpackChunksewaks_public||[]).push([[624],{3624:(S,u,a)=>{a.r(u),a.d(u,{CreditListModule:()=>D});var g=a(3403),o=a(6814),d=a(9090),t=a(5879),b=a(9494),m=a(924),h=a(2939),f=a(617);const C=["agGrid"];function N(r,E){1&r&&(t.TgZ(0,"h4",5),t._uU(1,"Loading ..."),t.qZA())}let v=(()=>{class r{constructor(s,e,n,i,l){this.gl=s,this.vol=e,this.datepipe=n,this._snackBar=i,this.tblUtl=l,this.status=[{id:1,view:"Decline"},{id:2,view:"New Submission"},{id:3,view:"Called"},{id:4,view:"Confirmed"}],this.excelData=[],this.loader=!1,this.columnDefs=[{headerName:"Name",field:"name",headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0,sortingOrder:["asc","desc"]},{headerName:"Email",field:"email"},{headerName:"Phone Number",field:"mobileNo"},{headerName:"Date",field:"joindate",valueGetter:c=>this.datepipe.transform(c.data.joindate,"dd-MM-yyyy")},{headerName:"Notes",field:"notes"},{headerName:"Referral Source",field:"referralSource"},{headerName:"Status",field:"status",valueGetter:c=>{switch(c.data.status){case 1:return"Decline";case 2:return"New Submission";case 3:return"Called";case 4:return"Verified As Volunteer";default:return"No Data"}}}],this.defaultColDef={editable:!1,resizable:!0,sortable:!0,filter:!0},this.gridOptions={defaultColDef:{sortable:!0}},this.rowSelection="single"}ngOnInit(){this.refresh()}refresh(){this.vol.GetAllByPagination().subscribe(e=>{e.respStatus&&(this.getpaged=e.lstModel),console.log(e)})}onGridReady(s){this.gridApi=s.api,this.gidColumnApi=s.columnApi,s.api.setRowData(this.getPaged)}clearFilter(){this.gridApi.setFilterModel(null)}onSelectionChanged(){this.gl.setRowData=null;const e=this.agGrid?.api.getSelectedNodes()?.map(n=>n.data);this.gl.setRowData=JSON.stringify(e[0])?e[0]:null}statusChange(s){this.gl.setRowData?(this.gl.setRowData.status=s,this.vol.update(this.gl.setRowData).subscribe(n=>{n.respStatus&&(this._snackBar.open("Update Successfully","Okay",{duration:3e3}),this.refresh())})):this._snackBar.open("Please fill required fields","Okay",{duration:3e3})}importExcel(s){this.loader=!0,this.tblUtl.importExcel(s),setTimeout(()=>{this.gl.xlsxData.forEach((e,n)=>{if(" "!=e.Credit){delete e.Debit,delete e.Balance,delete e.Value_Date,e.CreditAmount=String(e.Credit).trim(),delete e.Credit,e.PaymentDate=String(e.Txn_Date).trim(),delete e.Txn_Date;let i=String(e.Description).split("BY TRANSFER-");if(i.length>=2){if("N"==i[1][0]&&"E"==i[1][1]){let l=i[1].split("*");e.paymentMode=String(l[0]).trim()}else if("U"==i[1][0]&&"P"==i[1][1]){let l=i[1].split("/");e.paymentMode=String(l[0]).trim()}else if("I"==i[1][0]&&"N"==i[1][1])if(console.log(i[1][0],"bbbbbbb NEW IMPS"),"I"==i[2][0]&&"M"==i[2][1]){let l=i[1][0]+i[1][1]+i[1][2]+i[1][3];console.log(l,"bbbbbbb NEW IMPS"),e.paymentMode=String(l[1]).trim()}else if("N"==i[2][0]&&"E"==i[2][1]){let l=i[1].split(" ");console.log(l,"bbbbbbb NEW NEFT"),e.paymentMode=String(l[1]).trim()}else e.paymentMode=""}else e={};e.PanNo="",e.FirstName="",e.LastName="",e.Contact="",e.Email="",e.Address="",e.DateOfBirth="",e.BloodGroup="",e.exemption="",this.excelData.push(e)}}),this.excelData&&(d.E.exportArrayToExcel(this.excelData,"Sewaks"),this.loader=!1)},3e3)}static#e=this.\u0275fac=function(e){return new(e||r)(t.Y36(b.mD),t.Y36(m.Q),t.Y36(o.uU),t.Y36(h.ux),t.Y36(d.E))};static#t=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-credit-list-xlsx"]],viewQuery:function(e,n){if(1&e&&t.Gf(C,5),2&e){let i;t.iGM(i=t.CRH())&&(n.agGrid=i.first)}},decls:10,vars:1,consts:[[1,"d-flex","align-items-center","justify-content-center",2,"height","90vh","width","100%"],["type","file","id","import",2,"display","none",3,"change"],[1,"btn",2,"background-color","#f5b324","color","#ffffff"],["for","import"],["style","margin-top: 20px;\n        color: #00000075;\n        text-align: center;",4,"ngIf"],[2,"margin-top","20px","color","#00000075","text-align","center"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div")(2,"div")(3,"input",1),t.NdJ("change",function(l){return n.importExcel(l)}),t.qZA(),t.TgZ(4,"button",2)(5,"label",3)(6,"mat-icon"),t._uU(7,"upload_file"),t.qZA(),t._uU(8," Upload Excel"),t.qZA()()(),t.YNc(9,N,2,0,"h4",4),t.qZA()()),2&e&&(t.xp6(9),t.Q6J("ngIf",n.loader))},dependencies:[o.O5,f.Hw],encapsulation:2})}return r})();var p=a(6223),y=a(4807),x=a(5083);let D=(()=>{class r{static#e=this.\u0275fac=function(e){return new(e||r)};static#t=this.\u0275mod=t.oAB({type:r});static#i=this.\u0275inj=t.cJS({providers:[o.uU,d.E],imports:[o.ez,y.A0,p.u5,h.ZX,p.UX,x.sF,f.Ps,g.Bz.forChild([{path:"",component:v}])]})}return r})()}}]);